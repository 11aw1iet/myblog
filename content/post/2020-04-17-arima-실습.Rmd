---
title: ARIMA 실습
author: 이현탁
date: '2020-04-17'
slug: arima-실습
categories:
  - R
tags:
  - R Markdown
---
# 기초단계

```
install.packages("forecast")
library(forecast)
```
## AR(1)생성하기
```
x<-arima.sim(list(ma=0.2), n=100)
ts.plot(x, main="x")
par(mfrow=c(3,1))
acf(x, main="ACF")
pacf(x, main="PACF")
```

## MA(1)생성하기
```
x<-arima.sim(list(ma=0.8), n=100)
ts.plot(x, main="x")
par(mfrow=c(3,1))
acf(x, main="ACF ")
pacf(x, main="PACF ")
```

## ARMA(1,1)생성하기
```
x<-arima.sim(list(ar=0.4, ma=-0.3), n=100)
ts.plot(x, main="x")
par(mfrow=c(3,1))
acf(x, main="ACF ")
pacf(x, main="PACF ") 
```


# 실습
```
Y<-arima.sim(list(order=c(2,0,0), ar=c(0.3, 0.1)), n=100)
```
## 모형 식별하기
```
ts.plot(Y)
par(mfrow=c(2,1))
acf(Y, main="ACF ")
pacf(Y, main="PACF ")
```
## 모수 추정해보기
```
TS1 <- arima(Y, c(2, 0, 0))
TS1
TS1 <- arima(Y, c(2, 0, 0), method=c("CSS-ML"))
TS1
TS1 <- arima(Y, c(2, 0, 0), method=c("ML"))
TS1
TS1 <- arima(Y, c(2, 0, 0), method=c("CSS"))
TS1
```
## 모형 진단해보기
```
tsdiag(TS1, gof.lag=14)
```
## 모형 예측하기
```
future10<-predict(TS1, n.ahead=10)
future10
Upper<-future10$pred+future10$se
Lower<-future10$pred-future10$se
Upper
Lower

forecast(TS1,h=10)
plot(forecast(TS1,h=10))

```

## 차수 식별

```
install.packages("forecast")
library(forecast)
auto.arima(Y)
```



# 실습2
```
x<-arima.sim(list(ma=0.7), n=100)
par(mfrow=c(2,1))
acf(x, main="ACF ")
pacf(x, main="PACF ")
```

## 모수 추정하기
```
TS2 <- arima(x, c(0, 0, 1))
TS2
auto.arima(x)

```
## 모형의 진단
```
tsdiag(TS2,gof.lag=20)
```

## 모형의 예측
```
future20<-predict(TS2, n.ahead=20)
future20
Upper <- future20$pred+future20$se
Lower <- future20$pred-future20$se
Upper
Lower
forecast(TS2,h=20)
plot(forecast(TS2,h=20))

```

# 실습3
```
ARMA<-arima.sim(list(ar=0.3, ma=0.7), n=100)
ts.plot(ARMA)
par(mfrow=c(1,2))
acf(ARMA)
pacf(ARMA)


arm1 <- arima(ARMA, c(0, 0, 2))
arm1
arm2 <- arima(ARMA, c(1, 0, 1))
arm2
summary(arm1)
auto.arima(ARMA) 
tsdiag(arm,gof.lag=36)

forecast(arm1,h=20)
plot(forecast(arm2,h=20))

```

# 실습4
```
data<-read.table("stock.csv")
head(data)


install.packages("tseries")
library(tseries)

stock<-ts(data)
plot.ts(stock) #시도표 그리기
par(mfrow=c(2,1))
acf(stock,main="ACF", lag=36)
pacf(stock,main="PACF", lag=36)

```
## log변환
```
logstock<-log(stock)
plot(logstock)
```
## log변환 후 1차 차분시도
```
diff_logstock<-diff(logstock, lag=1)
plot(diff_logstock)
```
## acf, pacf
```
par(mfrow=c(2,1))
acf(diff_logstock,main="ACF", lag=36)
pacf(diff_logstock,main="PACF", lag=36, ylim=c(-0.2,1))
```
## 모형 선택
```
auto.arima(diff_logstock) # 자동으로 차수및 모수결정

arm3<-arima(logstock,c(2,1,2)) #AUTO.ARIMA에서 알려준대로
arm3
```
## 잔차검정
```
tsdiag(arm3)
```
## 예측값 포함된 plot
```
forecast(arm3)
plot(forecast(arm3))

pred<-predict(arm3, n.ahead=20)
pred
ts.plot(stock, 2.718^pred$pred, lty=c(1,3))

```
# 실습5
```
AirPassengers
plot(AirPassengers) #시도표 그리기
plot(stl(AirPassengers, s.window="periodic"))


logair<-log(AirPassengers) #분산안정화를 위해 log변환시킴
plot(logair)

log_diff1_air<-diff(logair)  #1차분시도
plot(log_diff1_air)

plot(stl(log_diff1_air, s.window="periodic"))

log_diff12_air<-diff(log_diff1_air, differences=12) #계절차분시도
plot(log_diff12_air)

par(mfrow=c(2,1))
acf(log_diff12_air,main="ACF" )
pacf(log_diff12_air,main="PACF") 


auto.arima(log_diff12_air) # 자동으로 차수및 모수결정

tsdiag(auto.arima(diff(logair)))

arm<-arima(logair,c(0,1,1), seasonal=list(order=c(0,1,1),period=12))
arm

tsdiag(arm)

pred<-predict(arm, n.ahead=10*12)
pred
ts.plot(AirPassengers, 2.718^pred$pred, lty=c(1,3))
```
