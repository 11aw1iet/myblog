---
title: ARIMA 실습
author: 이현탁
date: '2020-04-17'
slug: arima-실습
categories:
  - R
tags:
  - R Markdown
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="기초단계" class="section level1">
<h1>기초단계</h1>
<pre><code>install.packages(&quot;forecast&quot;)
library(forecast)</code></pre>
<div id="ar1생성하기" class="section level2">
<h2>AR(1)생성하기</h2>
<pre><code>x&lt;-arima.sim(list(ma=0.2), n=100)
ts.plot(x, main=&quot;x&quot;)
par(mfrow=c(3,1))
acf(x, main=&quot;ACF&quot;)
pacf(x, main=&quot;PACF&quot;)</code></pre>
</div>
<div id="ma1생성하기" class="section level2">
<h2>MA(1)생성하기</h2>
<pre><code>x&lt;-arima.sim(list(ma=0.8), n=100)
ts.plot(x, main=&quot;x&quot;)
par(mfrow=c(3,1))
acf(x, main=&quot;ACF &quot;)
pacf(x, main=&quot;PACF &quot;)</code></pre>
</div>
<div id="arma11생성하기" class="section level2">
<h2>ARMA(1,1)생성하기</h2>
<pre><code>x&lt;-arima.sim(list(ar=0.4, ma=-0.3), n=100)
ts.plot(x, main=&quot;x&quot;)
par(mfrow=c(3,1))
acf(x, main=&quot;ACF &quot;)
pacf(x, main=&quot;PACF &quot;) </code></pre>
</div>
</div>
<div id="실습" class="section level1">
<h1>실습</h1>
<pre><code>Y&lt;-arima.sim(list(order=c(2,0,0), ar=c(0.3, 0.1)), n=100)</code></pre>
<div id="모형-식별하기" class="section level2">
<h2>모형 식별하기</h2>
<pre><code>ts.plot(Y)
par(mfrow=c(2,1))
acf(Y, main=&quot;ACF &quot;)
pacf(Y, main=&quot;PACF &quot;)</code></pre>
</div>
<div id="모수-추정해보기" class="section level2">
<h2>모수 추정해보기</h2>
<pre><code>TS1 &lt;- arima(Y, c(2, 0, 0))
TS1
TS1 &lt;- arima(Y, c(2, 0, 0), method=c(&quot;CSS-ML&quot;))
TS1
TS1 &lt;- arima(Y, c(2, 0, 0), method=c(&quot;ML&quot;))
TS1
TS1 &lt;- arima(Y, c(2, 0, 0), method=c(&quot;CSS&quot;))
TS1</code></pre>
</div>
<div id="모형-진단해보기" class="section level2">
<h2>모형 진단해보기</h2>
<pre><code>tsdiag(TS1, gof.lag=14)</code></pre>
</div>
<div id="모형-예측하기" class="section level2">
<h2>모형 예측하기</h2>
<pre><code>future10&lt;-predict(TS1, n.ahead=10)
future10
Upper&lt;-future10$pred+future10$se
Lower&lt;-future10$pred-future10$se
Upper
Lower

forecast(TS1,h=10)
plot(forecast(TS1,h=10))
</code></pre>
</div>
<div id="차수-식별" class="section level2">
<h2>차수 식별</h2>
<pre><code>install.packages(&quot;forecast&quot;)
library(forecast)
auto.arima(Y)</code></pre>
</div>
</div>
<div id="실습2" class="section level1">
<h1>실습2</h1>
<pre><code>x&lt;-arima.sim(list(ma=0.7), n=100)
par(mfrow=c(2,1))
acf(x, main=&quot;ACF &quot;)
pacf(x, main=&quot;PACF &quot;)</code></pre>
<div id="모수-추정하기" class="section level2">
<h2>모수 추정하기</h2>
<pre><code>TS2 &lt;- arima(x, c(0, 0, 1))
TS2
auto.arima(x)
</code></pre>
</div>
<div id="모형의-진단" class="section level2">
<h2>모형의 진단</h2>
<pre><code>tsdiag(TS2,gof.lag=20)</code></pre>
</div>
<div id="모형의-예측" class="section level2">
<h2>모형의 예측</h2>
<pre><code>future20&lt;-predict(TS2, n.ahead=20)
future20
Upper &lt;- future20$pred+future20$se
Lower &lt;- future20$pred-future20$se
Upper
Lower
forecast(TS2,h=20)
plot(forecast(TS2,h=20))
</code></pre>
</div>
</div>
<div id="실습3" class="section level1">
<h1>실습3</h1>
<pre><code>ARMA&lt;-arima.sim(list(ar=0.3, ma=0.7), n=100)
ts.plot(ARMA)
par(mfrow=c(1,2))
acf(ARMA)
pacf(ARMA)


arm1 &lt;- arima(ARMA, c(0, 0, 2))
arm1
arm2 &lt;- arima(ARMA, c(1, 0, 1))
arm2
summary(arm1)
auto.arima(ARMA) 
tsdiag(arm,gof.lag=36)

forecast(arm1,h=20)
plot(forecast(arm2,h=20))
</code></pre>
</div>
<div id="실습4" class="section level1">
<h1>실습4</h1>
<pre><code>data&lt;-read.table(&quot;stock.csv&quot;)
head(data)


install.packages(&quot;tseries&quot;)
library(tseries)

stock&lt;-ts(data)
plot.ts(stock) #시도표 그리기
par(mfrow=c(2,1))
acf(stock,main=&quot;ACF&quot;, lag=36)
pacf(stock,main=&quot;PACF&quot;, lag=36)
</code></pre>
<div id="log변환" class="section level2">
<h2>log변환</h2>
<pre><code>logstock&lt;-log(stock)
plot(logstock)</code></pre>
</div>
<div id="log변환-후-1차-차분시도" class="section level2">
<h2>log변환 후 1차 차분시도</h2>
<pre><code>diff_logstock&lt;-diff(logstock, lag=1)
plot(diff_logstock)</code></pre>
</div>
<div id="acf-pacf" class="section level2">
<h2>acf, pacf</h2>
<pre><code>par(mfrow=c(2,1))
acf(diff_logstock,main=&quot;ACF&quot;, lag=36)
pacf(diff_logstock,main=&quot;PACF&quot;, lag=36, ylim=c(-0.2,1))</code></pre>
</div>
<div id="모형-선택" class="section level2">
<h2>모형 선택</h2>
<pre><code>auto.arima(diff_logstock) # 자동으로 차수및 모수결정

arm3&lt;-arima(logstock,c(2,1,2)) #AUTO.ARIMA에서 알려준대로
arm3</code></pre>
</div>
<div id="잔차검정" class="section level2">
<h2>잔차검정</h2>
<pre><code>tsdiag(arm3)</code></pre>
</div>
<div id="예측값-포함된-plot" class="section level2">
<h2>예측값 포함된 plot</h2>
<pre><code>forecast(arm3)
plot(forecast(arm3))

pred&lt;-predict(arm3, n.ahead=20)
pred
ts.plot(stock, 2.718^pred$pred, lty=c(1,3))
</code></pre>
</div>
</div>
<div id="실습5" class="section level1">
<h1>실습5</h1>
<pre><code>AirPassengers
plot(AirPassengers) #시도표 그리기
plot(stl(AirPassengers, s.window=&quot;periodic&quot;))


logair&lt;-log(AirPassengers) #분산안정화를 위해 log변환시킴
plot(logair)

log_diff1_air&lt;-diff(logair)  #1차분시도
plot(log_diff1_air)

plot(stl(log_diff1_air, s.window=&quot;periodic&quot;))

log_diff12_air&lt;-diff(log_diff1_air, differences=12) #계절차분시도
plot(log_diff12_air)

par(mfrow=c(2,1))
acf(log_diff12_air,main=&quot;ACF&quot; )
pacf(log_diff12_air,main=&quot;PACF&quot;) 


auto.arima(log_diff12_air) # 자동으로 차수및 모수결정

tsdiag(auto.arima(diff(logair)))

arm&lt;-arima(logair,c(0,1,1), seasonal=list(order=c(0,1,1),period=12))
arm

tsdiag(arm)

pred&lt;-predict(arm, n.ahead=10*12)
pred
ts.plot(AirPassengers, 2.718^pred$pred, lty=c(1,3))</code></pre>
</div>
